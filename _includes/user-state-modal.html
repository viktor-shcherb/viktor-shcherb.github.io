<div id="user-state-modal" class="contribute-modal">
  <div class="modal-overlay"></div>
  <div class="modal-content">
    <div class="modal-header">
      <h2>User State Settings</h2>
      <button type="button" class="modal-close" title="Close">
        <span class="material-symbols-outlined" aria-hidden="true">close</span>
        <span class="visually-hidden">Close</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="two-col" style="margin-top: 0; grid-template-columns: 1fr 1.7fr; align-items: end;">
        <div class="field">
          <p class="hint">The timeout is used to interrupt test runs that are too long.</p>
        </div>

        <div class="field">
          <label class="io-label" for="test-timeout" style="display:block; margin-top: 0;">
            <span>Timeout (seconds)</span>
          </label>
          <div class="input-wrapper">
            <input type="number" id="test-timeout" step="1" min="1" value="5">
            <div class="stepper">
              <button type="button" class="step up" aria-label="increment">+</button>
              <button type="button" class="step down" aria-label="decrement">−</button>
            </div>
          </div>
        </div>
      </div>

      <div id="auth-section" style="margin-top:2em;">
        <p class="hint">Authenticate to persist your editor state!</p>
        <button type="button" id="github-auth-btn" class="submit-btn">
          <img src="/assets/github/github-mark-white.svg"
                 alt="GitHub" class="submit-btn-icon">
          Authenticate
        </button>
      </div>

      <div id="pat-section" style="display:none; margin-top:2em; margin-bottom: 0">
        <p class="hint" style="margin-bottom: .5em">
          Provide a <strong>fine‑grained</strong> GitHub PAT and specify the repository to persist editor state.<br>
          Grant <strong>Contents (read &amp; write)</strong>; add <strong>Administration</strong> only if the repository must be created.<br>
          Do not grant extra scopes or include other repositories!
        </p>

        <div class="two-col" style="margin-top: 0">
          <div class="field">
            <label for="repo-input" class="io-label">
              <span>Repository</span>
            </label>
            <input id="repo-input" placeholder="owner/repo">
          </div>

          <div class="field">
            <label for="pat-input" class="io-label">
              <span>GitHub PAT</span>
            </label>
            <input id="pat-input" type="password" autocomplete="off">
            <div id="pat-valid" style="display:none; align-items:center; gap:.25em;">
              <span>PAT stored</span>
              <button type="button" id="delete-pat-btn" class="del-btn">
                <span class="material-symbols-outlined delete-icon">delete</span>
              </button>
            </div>
          </div>
        </div>


        <div class="action-row" style="margin-top:1em;">
          <button type="button" id="save-pat-btn" class="submit-btn">
            Save Settings
          </button>
          <button type="button" id="logout-btn" class="submit-btn" style="background: var(--red);">
            Logout
          </button>
        </div>
      </div>
      <p id="state-status" class="state-status" style="margin-top:.5em;"></p>
    </div>
  </div>
</div>
